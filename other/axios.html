<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Axios | Cyberloafing Journal</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" type="image/x-icon" href="/blog/assets/img/logo.png">
    <meta name="description" content="网络闲散日志">
    
    <link rel="preload" href="/blog/assets/css/0.styles.4d6f7a1c.css" as="style"><link rel="preload" href="/blog/assets/js/app.685e9e67.js" as="script"><link rel="preload" href="/blog/assets/js/2.ea4cc169.js" as="script"><link rel="preload" href="/blog/assets/js/1.ef8e2f7a.js" as="script"><link rel="preload" href="/blog/assets/js/97.e96c19c5.js" as="script"><link rel="preload" href="/blog/assets/js/4.3d7aea99.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.3fead202.js"><link rel="prefetch" href="/blog/assets/js/100.b738385f.js"><link rel="prefetch" href="/blog/assets/js/101.928f0605.js"><link rel="prefetch" href="/blog/assets/js/102.3765bf86.js"><link rel="prefetch" href="/blog/assets/js/103.424e3c76.js"><link rel="prefetch" href="/blog/assets/js/104.939abbd1.js"><link rel="prefetch" href="/blog/assets/js/105.9c64ba24.js"><link rel="prefetch" href="/blog/assets/js/106.b5cb1daf.js"><link rel="prefetch" href="/blog/assets/js/107.b4df2922.js"><link rel="prefetch" href="/blog/assets/js/108.5ecf8fe3.js"><link rel="prefetch" href="/blog/assets/js/109.40b1fd86.js"><link rel="prefetch" href="/blog/assets/js/11.20af3567.js"><link rel="prefetch" href="/blog/assets/js/110.452355b1.js"><link rel="prefetch" href="/blog/assets/js/111.7aae8dab.js"><link rel="prefetch" href="/blog/assets/js/112.49159006.js"><link rel="prefetch" href="/blog/assets/js/113.c5ce0594.js"><link rel="prefetch" href="/blog/assets/js/114.a652d929.js"><link rel="prefetch" href="/blog/assets/js/115.4976686d.js"><link rel="prefetch" href="/blog/assets/js/116.777d0aa3.js"><link rel="prefetch" href="/blog/assets/js/117.3c87590d.js"><link rel="prefetch" href="/blog/assets/js/118.56d07abf.js"><link rel="prefetch" href="/blog/assets/js/119.0dd36497.js"><link rel="prefetch" href="/blog/assets/js/12.542d78ea.js"><link rel="prefetch" href="/blog/assets/js/120.a88a20c6.js"><link rel="prefetch" href="/blog/assets/js/121.c67e0805.js"><link rel="prefetch" href="/blog/assets/js/122.a6920b7c.js"><link rel="prefetch" href="/blog/assets/js/123.612cfe66.js"><link rel="prefetch" href="/blog/assets/js/124.e08f9c18.js"><link rel="prefetch" href="/blog/assets/js/125.1d429d55.js"><link rel="prefetch" href="/blog/assets/js/126.857de57d.js"><link rel="prefetch" href="/blog/assets/js/127.066958fe.js"><link rel="prefetch" href="/blog/assets/js/128.efe2696f.js"><link rel="prefetch" href="/blog/assets/js/129.61ff4c5b.js"><link rel="prefetch" href="/blog/assets/js/13.76f5d807.js"><link rel="prefetch" href="/blog/assets/js/130.bde36a7e.js"><link rel="prefetch" href="/blog/assets/js/131.6fc0fea0.js"><link rel="prefetch" href="/blog/assets/js/132.50557ef5.js"><link rel="prefetch" href="/blog/assets/js/133.8e35ed84.js"><link rel="prefetch" href="/blog/assets/js/134.50b5c1b8.js"><link rel="prefetch" href="/blog/assets/js/135.84b89138.js"><link rel="prefetch" href="/blog/assets/js/136.cddcf7bf.js"><link rel="prefetch" href="/blog/assets/js/137.9c26d34c.js"><link rel="prefetch" href="/blog/assets/js/138.4bd806a2.js"><link rel="prefetch" href="/blog/assets/js/139.bb15552a.js"><link rel="prefetch" href="/blog/assets/js/14.a3469a2e.js"><link rel="prefetch" href="/blog/assets/js/140.e56c1ead.js"><link rel="prefetch" href="/blog/assets/js/141.b30720ab.js"><link rel="prefetch" href="/blog/assets/js/142.7502aaf9.js"><link rel="prefetch" href="/blog/assets/js/143.ef936dc6.js"><link rel="prefetch" href="/blog/assets/js/144.04062042.js"><link rel="prefetch" href="/blog/assets/js/145.1b48876e.js"><link rel="prefetch" href="/blog/assets/js/146.75a5b625.js"><link rel="prefetch" href="/blog/assets/js/147.3540b016.js"><link rel="prefetch" href="/blog/assets/js/148.fe895a0a.js"><link rel="prefetch" href="/blog/assets/js/15.780931f6.js"><link rel="prefetch" href="/blog/assets/js/16.d3572e03.js"><link rel="prefetch" href="/blog/assets/js/17.22c79afe.js"><link rel="prefetch" href="/blog/assets/js/18.e2bda6f4.js"><link rel="prefetch" href="/blog/assets/js/19.22191b5e.js"><link rel="prefetch" href="/blog/assets/js/20.83b5abe7.js"><link rel="prefetch" href="/blog/assets/js/21.3a1e1f2b.js"><link rel="prefetch" href="/blog/assets/js/22.d5d21c70.js"><link rel="prefetch" href="/blog/assets/js/23.1cb89f02.js"><link rel="prefetch" href="/blog/assets/js/24.b6ff7873.js"><link rel="prefetch" href="/blog/assets/js/25.77e783a3.js"><link rel="prefetch" href="/blog/assets/js/26.ecdf9a96.js"><link rel="prefetch" href="/blog/assets/js/27.05bd8c59.js"><link rel="prefetch" href="/blog/assets/js/28.e9b22090.js"><link rel="prefetch" href="/blog/assets/js/29.69931445.js"><link rel="prefetch" href="/blog/assets/js/3.295ef17d.js"><link rel="prefetch" href="/blog/assets/js/30.6a7ec01e.js"><link rel="prefetch" href="/blog/assets/js/31.60ea109c.js"><link rel="prefetch" href="/blog/assets/js/32.02267386.js"><link rel="prefetch" href="/blog/assets/js/33.439071f2.js"><link rel="prefetch" href="/blog/assets/js/34.bc91ecee.js"><link rel="prefetch" href="/blog/assets/js/35.1b5cab8f.js"><link rel="prefetch" href="/blog/assets/js/36.82f4e678.js"><link rel="prefetch" href="/blog/assets/js/37.6ef9fb6b.js"><link rel="prefetch" href="/blog/assets/js/38.3f280ebc.js"><link rel="prefetch" href="/blog/assets/js/39.764eaf13.js"><link rel="prefetch" href="/blog/assets/js/40.66955bc9.js"><link rel="prefetch" href="/blog/assets/js/41.9051478d.js"><link rel="prefetch" href="/blog/assets/js/42.cfc2ab5e.js"><link rel="prefetch" href="/blog/assets/js/43.a072f49a.js"><link rel="prefetch" href="/blog/assets/js/44.167f849e.js"><link rel="prefetch" href="/blog/assets/js/45.1c2e44cc.js"><link rel="prefetch" href="/blog/assets/js/46.6f9e740e.js"><link rel="prefetch" href="/blog/assets/js/47.4e5b090f.js"><link rel="prefetch" href="/blog/assets/js/48.39bbe60c.js"><link rel="prefetch" href="/blog/assets/js/49.30e45b5e.js"><link rel="prefetch" href="/blog/assets/js/5.0ce5c4e2.js"><link rel="prefetch" href="/blog/assets/js/50.c80b31ac.js"><link rel="prefetch" href="/blog/assets/js/51.23999b13.js"><link rel="prefetch" href="/blog/assets/js/52.ec74d061.js"><link rel="prefetch" href="/blog/assets/js/53.9da5e60d.js"><link rel="prefetch" href="/blog/assets/js/54.62ce711f.js"><link rel="prefetch" href="/blog/assets/js/55.5392b9d2.js"><link rel="prefetch" href="/blog/assets/js/56.6eb19339.js"><link rel="prefetch" href="/blog/assets/js/57.007f8227.js"><link rel="prefetch" href="/blog/assets/js/58.eda46e09.js"><link rel="prefetch" href="/blog/assets/js/59.d0ea3bee.js"><link rel="prefetch" href="/blog/assets/js/6.ce6a3882.js"><link rel="prefetch" href="/blog/assets/js/60.a20990ac.js"><link rel="prefetch" href="/blog/assets/js/61.8eee472b.js"><link rel="prefetch" href="/blog/assets/js/62.ca10e17b.js"><link rel="prefetch" href="/blog/assets/js/63.5269760f.js"><link rel="prefetch" href="/blog/assets/js/64.8a173884.js"><link rel="prefetch" href="/blog/assets/js/65.1579c145.js"><link rel="prefetch" href="/blog/assets/js/66.bab24a02.js"><link rel="prefetch" href="/blog/assets/js/67.fcc7f968.js"><link rel="prefetch" href="/blog/assets/js/68.aad00f5d.js"><link rel="prefetch" href="/blog/assets/js/69.48fecf96.js"><link rel="prefetch" href="/blog/assets/js/7.691eaf6b.js"><link rel="prefetch" href="/blog/assets/js/70.539f7918.js"><link rel="prefetch" href="/blog/assets/js/71.1e6f40c5.js"><link rel="prefetch" href="/blog/assets/js/72.100a9f4f.js"><link rel="prefetch" href="/blog/assets/js/73.30d88176.js"><link rel="prefetch" href="/blog/assets/js/74.2732a33d.js"><link rel="prefetch" href="/blog/assets/js/75.190f9f2c.js"><link rel="prefetch" href="/blog/assets/js/76.6f93a54a.js"><link rel="prefetch" href="/blog/assets/js/77.3f9ad2c4.js"><link rel="prefetch" href="/blog/assets/js/78.9d97211b.js"><link rel="prefetch" href="/blog/assets/js/79.0e2a8ba5.js"><link rel="prefetch" href="/blog/assets/js/80.c89f8dc2.js"><link rel="prefetch" href="/blog/assets/js/81.8d06ada9.js"><link rel="prefetch" href="/blog/assets/js/82.0c44893f.js"><link rel="prefetch" href="/blog/assets/js/83.6a892b40.js"><link rel="prefetch" href="/blog/assets/js/84.f9b9f575.js"><link rel="prefetch" href="/blog/assets/js/85.71221f4a.js"><link rel="prefetch" href="/blog/assets/js/86.2eb37cbb.js"><link rel="prefetch" href="/blog/assets/js/87.4869f90b.js"><link rel="prefetch" href="/blog/assets/js/88.b0e8c2e7.js"><link rel="prefetch" href="/blog/assets/js/89.16302274.js"><link rel="prefetch" href="/blog/assets/js/90.6f45e316.js"><link rel="prefetch" href="/blog/assets/js/91.33b33960.js"><link rel="prefetch" href="/blog/assets/js/92.ff444cba.js"><link rel="prefetch" href="/blog/assets/js/93.af6e1b99.js"><link rel="prefetch" href="/blog/assets/js/94.ff7315b6.js"><link rel="prefetch" href="/blog/assets/js/95.1b5de7ac.js"><link rel="prefetch" href="/blog/assets/js/96.c433e363.js"><link rel="prefetch" href="/blog/assets/js/98.ecd6b953.js"><link rel="prefetch" href="/blog/assets/js/99.978a4884.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.4577488c.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.4d6f7a1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/img/logo.png" alt="Cyberloafing Journal" class="logo"> <span class="site-name can-hide">Cyberloafing Journal</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/js/" class="nav-link">
  Javascript
</a></div><div class="nav-item"><a href="/blog/es6/" class="nav-link">
  ES6
</a></div><div class="nav-item"><a href="/blog/jquery/" class="nav-link">
  jQuery
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/ts/" class="nav-link">
  Typescript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Other</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/axios/" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/npm/" class="nav-link">
  Npm
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/uni-app/" class="nav-link">
  Uni-App
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/vite/" class="nav-link">
  Vite
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/js/" class="nav-link">
  Javascript
</a></div><div class="nav-item"><a href="/blog/es6/" class="nav-link">
  ES6
</a></div><div class="nav-item"><a href="/blog/jquery/" class="nav-link">
  jQuery
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/ts/" class="nav-link">
  Typescript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Other</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/axios/" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/npm/" class="nav-link">
  Npm
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/uni-app/" class="nav-link">
  Uni-App
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/other/vite/" class="nav-link">
  Vite
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Other</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/other/git.html" class="sidebar-link">Git</a></li><li><a href="/blog/other/nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/blog/other/axios.html" aria-current="page" class="active sidebar-link">Axios</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/other/axios.html#请求方法别名" class="sidebar-link">请求方法别名</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/other/axios.html#axios-get" class="sidebar-link">axios.get</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#axios-post" class="sidebar-link">axios.post</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#axios-all" class="sidebar-link">axios.all</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#axios-spread" class="sidebar-link">axios.spread</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#axios-create" class="sidebar-link">axios.create</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#响应对象" class="sidebar-link">响应对象</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#请求配置" class="sidebar-link">请求配置</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#全局url" class="sidebar-link">全局URL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/other/axios.html#url的优先级" class="sidebar-link">URL的优先级</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#取消请求" class="sidebar-link">取消请求</a></li><li class="sidebar-sub-header"><a href="/blog/other/axios.html#拦截器" class="sidebar-link">拦截器</a></li></ul></li><li><a href="/blog/other/npm.html" class="sidebar-link">Npm</a></li><li><a href="/blog/other/uni-app.html" class="sidebar-link">Uni-App</a></li><li><a href="/blog/other/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/blog/other/vite.html" class="sidebar-link">Vite</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="axios"><a href="#axios" class="header-anchor">#</a> Axios</h1> <p>axios的主要功能用于向服务端发送请求，接收响应。axios和ajax在底层都是用<code>XMLHttpRequest</code>对象来实现的。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i axios <span class="token parameter variable">-S</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>axios本身是一个函数，返回值是一个Promise对象，因此可以用<code>then</code>异步接收它请求的数据，用<code>catch</code>捕获请求发生的错误：</p> <p><strong><code>axios(url[, config])</code></strong>：发起网络请求，返回一个Promise对象。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>url</td> <td>请求的地址</td></tr> <tr><td>config</td> <td>请求的配置对象</td></tr> <tr><td><strong>返回值</strong></td> <td>Promise对象</td></tr></tbody></table> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>配置对象</strong>的常见属性：</p> <table><thead><tr><th>属性</th> <th>描述</th></tr></thead> <tbody><tr><td>url</td> <td>请求的地址，若忽略实参一的url，则该项必传</td></tr> <tr><td>method</td> <td>请求的方式，默认get</td></tr> <tr><td>params</td> <td>params参数，用于get请求</td></tr> <tr><td>data</td> <td>body参数，常用于post请求</td></tr> <tr><td>timeout</td> <td>请求超时的毫秒数</td></tr> <tr><td>responseType</td> <td>响应的数据类型，默认为JSON</td></tr></tbody></table> <p>下面是使用axios分别发起get请求和post请求的例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="请求方法别名"><a href="#请求方法别名" class="header-anchor">#</a> 请求方法别名</h2> <p>为方便发起请求，axios为所有支持的请求方法提供了别名：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// GET</span>
axios<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// POST</span>
axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">,</span> config<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>本文介绍GET&amp;POST请求</p> <h3 id="axios-get"><a href="#axios-get" class="header-anchor">#</a> axios.get</h3> <p><strong><code>axios.get(url[, config])</code></strong>：发送get请求。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>url</td> <td>请求的地址</td></tr> <tr><td>config</td> <td>可选的配置对象，同<code>axios()</code>的配置对象</td></tr> <tr><td>返回值</td> <td>Promise对象</td></tr></tbody></table> <p>使用<code>axios.get()</code>传递请求参数有2种方式</p> <ol><li><strong>写在配置对象的<code>params</code>属性中</strong> <span class="badge tip" style="vertical-align:top;" data-v-1b4a4e45>推荐</span>：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li><strong>手动拼接在url地址后面</strong>：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr> <h3 id="axios-post"><a href="#axios-post" class="header-anchor">#</a> axios.post</h3> <p><strong><code>axios.post(url[, data[, config]])</code></strong>：发送post请求。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>url</td> <td>请求的地址</td></tr> <tr><td>data</td> <td>请求的参数，可选的键值对对象，或者可选的字符串，以url参数的格式传递参数</td></tr> <tr><td>config</td> <td>可选的配置对象，同<code>axios()</code>的配置对象</td></tr> <tr><td>返回值</td> <td>Promise对象</td></tr></tbody></table> <ul><li><strong>使用<code>axios.post()</code>传递JSON参数</strong>，直接通过第二实参来传递<strong>对象</strong>即可：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>使用<code>axios.post()</code>传递FormData参数</strong>，通过第二实参来传递<strong>x-www-form-urlencoded格式的数据</strong>：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;y=2&amp;z=3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>JS的<code>FormData</code>实例对象也会被识别，当成<strong>FormData参数</strong>传递过去：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span> formData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>传递二进制文件，不可通过<strong>JSON参数</strong>的形式传递，只能通过<strong>FormData参数</strong>来传递。</p></div> <div class="custom-block tip"><p class="custom-block-title">知识点</p> <p>POST 请求可以同时携带<code>params</code>参数和<code>body</code>参数，因为POST拥有请求体。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
  <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">3</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>而Axios不支持GET请求携带<code>body</code>参数，因为带有请求体的GET请求信息存在未定义的语义，发送带有<code>body</code>的GET请求将会导致某些现有实现拒绝该请求。换言之，在GET请求里带<code>body</code>存在风险，就算服务器不会忽略GET请求的<code>body</code>，各种代理和缓存可能也会过滤<code>body</code>。</p></div> <h3 id="axios-all"><a href="#axios-all" class="header-anchor">#</a> axios.all</h3> <p><strong><code>axios.all(iterable)</code></strong>：发送并发请求。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>iterable</td> <td>请求数组</td></tr> <tr><td>返回值</td> <td>Promise对象</td></tr></tbody></table> <p>同时发送多个请求，底层根据<code>Promise.all</code>来实现：当数组里面的所有Promise对象状态为<code>fulfilled</code>时，返回的这个Promise状态才为<code>fulfilled</code>，换言之，此时才会继续执行<code>then()</code>，一旦有一个请求失败，返回的Promise状态将为<code>rejected</code>，此时会执行<code>catch()</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>then()</code>回调函数的参数是一个数组，数组依次保存了每一个请求返回的数据。</p> <h3 id="axios-spread"><a href="#axios-spread" class="header-anchor">#</a> axios.spread</h3> <p><strong><code>axios.spread(callback)</code></strong>：处理并发请求。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>callback</td> <td>回调函数</td></tr></tbody></table> <p><code>axios.spread</code>用于处理并发请求响应的数据，该方法只能在<code>axios.all</code>的<code>then()</code>里调用，它的参数是一个回调函数，回调函数的每一个参数就是<code>axios.all</code>的每一个响应结果，所以该方法一般和<code>axios.all</code>搭配使用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json?x=1&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res1<span class="token punctuation">,</span> res2<span class="token punctuation">,</span> res3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res3<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="axios-create"><a href="#axios-create" class="header-anchor">#</a> axios.create</h3> <p><strong><code>axios.create([config])</code></strong>：创建一个axios实例。</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>config</td> <td>可选的配置对象，同<code>axios()</code>的配置对象</td></tr> <tr><td>返回值</td> <td>axios实例</td></tr></tbody></table> <p><code>axios.create()</code>通常用于对axios的二次封装使用，因为返回的axios实例也支持通过实例方法发起请求，并且每个请求的配置都采用<code>axios.create</code>传入的配置对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> instace <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">&quot;http://www.example.com/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 公共URL</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">3000</span> <span class="token comment">// 超时时间</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// http://www.example.com/data.json</span>
instace<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;data.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// http://www.example.com/data.json</span>
instace<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;data.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="响应对象"><a href="#响应对象" class="header-anchor">#</a> 响应对象</h2> <p>axios将服务端返回的信息包装成了一个响应信息对象，对象内包含了一系列响应的信息：</p> <ul><li><strong><code>data</code></strong>：响应的内容。</li> <li><strong><code>status</code></strong>：响应的http状态码。</li> <li><strong><code>statusText</code></strong>：响应的状态信息（如：200返回<code>OK</code>，304返回<code>Not Modified</code>，404返回<code>Not Found</code>）。</li> <li><strong><code>headers</code></strong>：响应头信息。</li> <li><strong><code>config</code></strong>：请求的配置对象。</li> <li><strong><code>request</code></strong>：请求的<code>XMLHttpRequest</code>对象。</li></ul> <h2 id="请求配置"><a href="#请求配置" class="header-anchor">#</a> 请求配置</h2> <p>配置对象里，除了前面所讲的<code>url</code>、<code>method</code>、<code>params</code>、<code>data</code>、<code>responseType</code>之外，还有许多的配置属性：</p> <ul><li><strong><code>baseURL</code></strong>：将会自动加在url前面，用的比较少，通常是用<a href="/blog/other/axios.html#全局url">全局URL</a> 。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 请求 http://www.example.com/add</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">&quot;http://www.example.com/&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong><code>headers</code></strong>：设置请求头信息。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'X-Requested-With'</span><span class="token operator">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong><code>timeout</code></strong>：设置请求超时的信息，单位是毫秒，如果在这段时间内还没有收到服务端的响应数据，将中断本次请求。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token comment">// 5min超时</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong><code>withCredentials</code></strong>：跨域请求时，是否携带cookie信息。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">withCredentials</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 跨域时，携带cookie信息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong><code>transformRequest</code></strong>：一个数组，数组里有一个函数，在向服务端发起请求之前执行该函数，函数内的参数就是发送请求的参数，可以在发送请求之前，在该函数内对参数数据进行加工改造。</li></ul> <ol><li>该参数只能在 PUT，POST 和 PATCH 的请求方式内才生效，GET 方式无效。</li> <li>函数内对数据加工完毕后，必须以<strong>字符串</strong>的形式<code>return</code>将数据返回。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">transformRequest</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span>
      <span class="token keyword">return</span> data
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>因为<code>transformRequest</code>返回的是字符串形式的参数，如果使用了<code>transformRequest</code>修改了post的参数对象，那么请求的对象参数会变成<code>[object Object]</code>，此时需要引入<code>Qs</code>这个库，将其转为正常参数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">transformRequest</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span>
      <span class="token keyword">return</span> Qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>Qs</code>库在安装axios时，就已安装。</p></div> <ul><li><strong><code>transformResponse</code></strong>：一个数组，数组里有一个函数，在服务端响应数据到<code>then</code>之前执行该函数，函数内的参数就是服务端响应的参数，可以在<code>then</code>接收响应之前，在该函数内对响应的数据进行加工改造。</li></ul> <ol><li>它不像<code>transformRequest</code>一样只对 POST 请求生效，在 GET 方式下也行。</li> <li>数据加工完毕后，一样的必须将数据返回。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">transformResponse</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> data
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>这种方式最早获取响应的数据，但是axios还未将JSON数据转化为对象，所以在这里面获取到的数据不是对象，而是普通的字符串。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">transformResponse</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">// 手动反序列化</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <ul><li><p><strong><code>onUploadProgress</code></strong>：处理上传进度的回调函数，函数内的形参包含了上传进度的一系列信息。</p></li> <li><p><strong><code>onDownloadProgress</code></strong>：处理下载进度的回调函数，函数内的形参包含了下载进度的一系列信息。</p></li> <li><p><strong><code>cancelToken</code></strong>：指定该请求的cancel Token，可用于<a href="/blog/other/axios.html#取消请求">取消请求</a>。</p></li></ul> <h2 id="全局url"><a href="#全局url" class="header-anchor">#</a> 全局URL</h2> <p>在实际开发中，请求的接口地址大多指向同一个域名，只是接口的路径文件不同，例如：</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>http://www.example.com/user/list
http://www.example.com/user/add
http://www.example.com/user/update
http://www.example.com/user/delete
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这时候可以给axios配置一个全局的默认路径：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">'http://www.example.com/'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将来再通过axios发送请求，就可以省略url了，会默认使用这个全局的路径</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/&quot;</span>

<span class="token comment">// 下面三个调用都会请求 http://www.example.com/</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>请求不同的接口，只需要拼接上接口的路径即可：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/&quot;</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;user/list&quot;</span><span class="token punctuation">)</span> <span class="token comment">// http://www.example.com/user/list</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user/detail&quot;</span><span class="token punctuation">)</span> <span class="token comment">// http://www.example.com/user/detail</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;user/add&quot;</span><span class="token punctuation">)</span> <span class="token comment">// http://www.example.com/user/add</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>如果url传的是绝对路径，那么这条请求就会覆盖默认的路径：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/&quot;</span>

<span class="token comment">// http://www.example2.com/user/list</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.example2.com/user/list&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// http://www.example.com/user/list</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;user/list&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <p>全局的url也可以指定为某个接口，</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/user/list&quot;</span>

<span class="token comment">// http://www.example.com/user/list</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// http://www.example.com/user/list/add</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果将来某个请求想替换这个接口，需要在拼接的接口前面加上<code>../</code>表示要覆盖全局的接口。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/user/list&quot;</span>

<span class="token comment">// http://www.example.com/user/add</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;../add&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="url的优先级"><a href="#url的优先级" class="header-anchor">#</a> URL的优先级</h3> <p>如果配置了 全局url、实参url、配置对象url，此时优先级是 <strong>实参url</strong> &gt; <strong>配置对象url</strong> &gt; <strong>全局url</strong>。</p> <p>其实，<code>实参url</code>就是<code>配置对象url</code>，配置对象设置了<code>url</code>属性，实参再指定url，就相当于是把配置对象的<code>url</code>的给覆盖了：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;http://www.example.com/user/list&quot;</span>

<span class="token comment">// http://www.example.com/user/add</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;../add&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;../update&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// http://www.example.com/user/update</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;../update&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="取消请求"><a href="#取消请求" class="header-anchor">#</a> 取消请求</h2> <p>axios跟ajax一样用于发送http请求，ajax采用的是<code>xhr.abort()</code>方法来取消请求。axios底层也是采用<code>abort()</code>来取消，只不过axios将它给封装了一下。</p> <ol><li>首先需要生成一个<code>source</code>对象，并通过<code>source</code>对象来生成<code>cancelToken</code>，用于标识当前请求。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> CancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken
<span class="token keyword">const</span> source <span class="token operator">=</span> CancelToken<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 生成source对象</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>将这个<code>cancelToken</code>挂载到当前请求的配置对象上。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelToken</span><span class="token operator">:</span> source<span class="token punctuation">.</span>token <span class="token comment">// 将cancelToken挂载到配置对象上</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="3"><li>调用<code>source</code>对象的<code>cancel()</code>方法用于取消请求。<code>source()</code>方法有一个可选参数，参数接收一个描述字符串，当请求被取消时，在<code>catch()</code>回调中，可以通过<code>回调参数.message</code>来获取该段描述。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>source <span class="token operator">&amp;&amp;</span> source<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&quot;请求被取消&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 取消请求</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><hr> <p>下面是一个利用<code>cancelToken</code>实现<strong>取消上传</strong>文件功能，并且具有<strong>暂停上传</strong>和<strong>继续上传</strong>的Demo：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    上传进度：{{ progress.rate }}%
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>
    选择文件：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeHandler<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendAjax<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>上传文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cancel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>暂停上传<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>resume<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>继续上传<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">progress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rate</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 比例</span>
        <span class="token literal-property property">currentLoaded</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 当前进度</span>
        <span class="token literal-property property">totalLoaded</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 总进度</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 选择文件</span>
    <span class="token function">changeHandler</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>file <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传文件</span>
    <span class="token function">sendAjax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 继续上传</span>
    <span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取剩余数据</span>
      <span class="token keyword">var</span> fileData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>currentLoaded<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>file<span class="token punctuation">.</span>size
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadRequest</span><span class="token punctuation">(</span>fileData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 取消上传</span>
    <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>source<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&quot;请求被取消&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 上传请求</span>
    <span class="token function">uploadRequest</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> CancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>source <span class="token operator">=</span> CancelToken<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取source对象</span>

      <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化表单对象</span>

      <span class="token keyword">var</span> oldValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> difValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      axios
        <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">,</span> fd<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token function-variable function">onUploadProgress</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 处理进度</span>
            difValue <span class="token operator">=</span> newValue<span class="token punctuation">.</span>loaded <span class="token operator">-</span> oldValue<span class="token punctuation">;</span> <span class="token comment">// 差值</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>currentLoaded <span class="token operator">+=</span> difValue<span class="token punctuation">;</span> <span class="token comment">// 当前进度</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>totalLoaded <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>file<span class="token punctuation">.</span>size<span class="token punctuation">;</span> <span class="token comment">// 总进度</span>
            <span class="token comment">// 百分比</span>
            <span class="token keyword">var</span> progress <span class="token operator">=</span>
              <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>currentLoaded <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>totalLoaded<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>progress<span class="token punctuation">.</span>rate <span class="token operator">=</span>
              Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">?</span> <span class="token number">100</span> <span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
            oldValue <span class="token operator">=</span> newValue<span class="token punctuation">.</span>loaded<span class="token punctuation">;</span> <span class="token comment">// 更新旧值</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">cancelToken</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>source<span class="token punctuation">.</span>token<span class="token punctuation">,</span> <span class="token comment">// 携带标识</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br></div></div><h2 id="拦截器"><a href="#拦截器" class="header-anchor">#</a> 拦截器</h2> <p>axios的拦截器可以在请求发起之前，对请求的配置对象进行加工处理，以及数据响应之前，对响应的数据进行处理。</p> <p><strong><code>axios.interceptors.request.use(requestSuccess, requestFailed)</code></strong>：请求拦截器，在请求发起之前，执行<code>requestSuccess</code>回调函数，若请求失败，则执行<code>requestFailed</code>回调函数。</p> <ul><li><code>requestSuccess</code>的参数就是当前请求的配置对象，且必须将该配置对象返回。</li> <li><code>requestFailed</code>的参数包含了请求失败的信息。</li></ul> <hr> <p><strong><code>axios.interceptors.request.use(responseSuccess, responseFailed)</code></strong>：响应拦截器，当接口正常响应时，执行<code>responseSuccess</code>，响应异常则会执行<code>responseFailed</code>回调函数。</p> <ul><li><code>responseSuccess</code>的参数就是axios响应对象，可以在这里进行数据处理。同样的，<code>responseSuccess</code>必须将该响应对象返回。</li> <li><code>responseFailed</code>的参数包含了响应失败的信息。</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>拦截器通常用于拦截整个配置对象或者响应对象本身，例如请求头、响应状态码等等。而<code>transformRequest</code>、<code>transformResponse</code>可以用来处理请求的参数或者响应对象的数据。</p></div> <p>使用拦截器实现一个cookie通信机制：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 添加请求拦截器 (获取cookie发送)</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> token
    <span class="token keyword">return</span> config
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// 添加响应拦截器 (接收cookie保存)</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">&quot;./data.json&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><!----></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/other/nginx.html" class="prev">
        Nginx
      </a></span> <span class="next"><a href="/blog/other/npm.html">
        Npm
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.685e9e67.js" defer></script><script src="/blog/assets/js/2.ea4cc169.js" defer></script><script src="/blog/assets/js/1.ef8e2f7a.js" defer></script><script src="/blog/assets/js/97.e96c19c5.js" defer></script><script src="/blog/assets/js/4.3d7aea99.js" defer></script>
  </body>
</html>
